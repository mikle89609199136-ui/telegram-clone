<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Zhuravlev Telegram</title>
  <style>
    /* ========== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –°–¢–ò–õ–ò (Telegram —Ç–µ–º–∞) ========== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    }

    body {
      background-color: #0e1621;
      color: #fff;
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      transition: background 0.2s;
    }

    /* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ */
    body.light-theme {
      background-color: #f5f5f5;
      color: #000;
    }
    body.light-theme .top-bar,
    body.light-theme .bottom-nav,
    body.light-theme .chat-header,
    body.light-theme .input-area,
    body.light-theme .search-box,
    body.light-theme .settings-item {
      background-color: #fff;
      border-color: #e0e0e0;
      color: #000;
    }
    body.light-theme .chat-item {
      background-color: #fff;
      border-bottom: 1px solid #e0e0e0;
    }
    body.light-theme .message.other .message-bubble {
      background-color: #e4e6eb;
      color: #000;
    }
    body.light-theme .chat-last-msg,
    body.light-theme .chat-time,
    body.light-theme .chat-status,
    body.light-theme .nav-item {
      color: #5e6f7e;
    }
    body.light-theme .nav-item.active {
      color: #2ea6ff;
    }

    /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —ç–∫—Ä–∞–Ω–æ–≤ */
    .screen {
      display: none;
      height: 100%;
      flex-direction: column;
    }
    .screen.active {
      display: flex;
    }

    /* ========== –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–° (—Ç–æ–ª—å–∫–æ —á–∞—Ç –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏) ========== */
    #main-screen {
      background: #0e1621;
      height: 100%;
    }

    /* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å */
    .top-bar {
      background: #17212b;
      padding: 12px 16px;
      display: flex;
      align-items: center;
      border-bottom: 1px solid #2b3b4a;
    }
    .top-bar h1 {
      flex: 1;
      font-size: 20px;
      font-weight: 600;
    }
    .top-bar .edit-btn {
      color: #2ea6ff;
      background: none;
      border: none;
      font-size: 16px;
      margin-right: 16px;
      cursor: pointer;
    }
    .top-bar .create-btn {
      background: none;
      border: none;
      font-size: 24px;
      color: #2ea6ff;
      cursor: pointer;
    }

    /* –ü–æ–∏—Å–∫ */
    .search-box {
      padding: 8px 16px;
      background: #17212b;
    }
    .search-box input {
      width: 100%;
      padding: 12px 18px;
      background: #242f3d;
      border: none;
      border-radius: 24px;
      color: #fff;
      outline: none;
    }
    body.light-theme .search-box input {
      background: #f0f2f5;
      color: #000;
    }

    /* –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è */
    .bottom-nav {
      display: flex;
      background: #17212b;
      border-top: 1px solid #2b3b4a;
      padding: 8px 0;
    }
    .nav-item {
      flex: 1;
      text-align: center;
      color: #8e9eae;
      font-size: 12px;
      padding: 8px;
      cursor: pointer;
      transition: color 0.2s;
    }
    .nav-item.active {
      color: #2ea6ff;
    }
    .nav-item i {
      display: block;
      font-size: 24px;
      margin-bottom: 4px;
    }

    /* –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ */
    .chats-list {
      flex: 1;
      overflow-y: auto;
      padding: 0;
    }
    .chat-item {
      display: flex;
      align-items: center;
      padding: 12px 16px;
      background: #0e1621;
      border-bottom: 1px solid #17212b;
      cursor: pointer;
      transition: background 0.2s;
    }
    .chat-item:hover {
      background: #1a2633;
    }
    .chat-avatar {
      width: 54px;
      height: 54px;
      border-radius: 50%;
      background: #2ea6ff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      color: #fff;
      margin-right: 12px;
      flex-shrink: 0;
    }
    .chat-info {
      flex: 1;
      min-width: 0;
    }
    .chat-name {
      font-weight: 600;
      margin-bottom: 4px;
    }
    .chat-last-msg {
      color: #8e9eae;
      font-size: 14px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .chat-meta {
      text-align: right;
      font-size: 12px;
      color: #8e9eae;
    }
    .chat-time {
      margin-bottom: 4px;
    }
    .chat-status {
      color: #2ea6ff;
    }

    /* –û–∫–Ω–æ —á–∞—Ç–∞ */
    .chat-window {
      display: flex;
      flex-direction: column;
      height: 100%;
      background: #0e1621;
    }
    .chat-header {
      background: #17212b;
      padding: 12px 16px;
      display: flex;
      align-items: center;
      border-bottom: 1px solid #2b3b4a;
    }
    .back-btn {
      background: none;
      border: none;
      color: #2ea6ff;
      font-size: 24px;
      margin-right: 12px;
      cursor: pointer;
    }
    .chat-header-info {
      flex: 1;
    }
    .chat-header-name {
      font-weight: 600;
    }
    .chat-header-status {
      font-size: 12px;
      color: #8e9eae;
    }
    .messages-area {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
      display: flex;
      flex-direction: column;
    }
    .message {
      max-width: 80%;
      margin-bottom: 8px;
      display: flex;
      flex-direction: column;
    }
    .message.own {
      align-self: flex-end;
    }
    .message-bubble {
      background: #17212b;
      border-radius: 18px;
      padding: 8px 12px;
      color: #fff;
      word-wrap: break-word;
      position: relative;
    }
    .message.own .message-bubble {
      background: #2ea6ff;
    }
    .message-time {
      font-size: 10px;
      color: #8e9eae;
      margin-top: 2px;
      align-self: flex-end;
    }
    .message.own .message-time {
      color: #b3d9ff;
    }
    .message.own .message-bubble::after {
      content: '';
      position: absolute;
      bottom: 0;
      right: -8px;
      width: 0;
      height: 0;
      border: 8px solid transparent;
      border-top-color: #2ea6ff;
      border-bottom: 0;
      border-right: 0;
    }
    .message.other .message-bubble::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: -8px;
      width: 0;
      height: 0;
      border: 8px solid transparent;
      border-top-color: #17212b;
      border-bottom: 0;
      border-left: 0;
    }

    /* –§–∞–π–ª–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è */
    .file-message {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .file-icon {
      font-size: 24px;
    }
    .file-name {
      font-size: 14px;
      word-break: break-word;
    }

    /* –ü–æ–ª–µ –≤–≤–æ–¥–∞ */
    .input-area {
      background: #17212b;
      padding: 12px 16px;
      display: flex;
      align-items: center;
      border-top: 1px solid #2b3b4a;
    }
    .attach-btn {
      background: none;
      border: none;
      font-size: 24px;
      color: #8e9eae;
      margin-right: 12px;
      cursor: pointer;
    }
    .input-wrapper {
      flex: 1;
      background: #242f3d;
      border-radius: 24px;
      padding: 8px 16px;
      display: flex;
      align-items: center;
    }
    .input-wrapper input {
      flex: 1;
      background: transparent;
      border: none;
      color: #fff;
      outline: none;
      font-size: 16px;
    }
    .input-wrapper input::placeholder {
      color: #5e6f7e;
    }
    .emoji-btn, .voice-btn {
      background: none;
      border: none;
      font-size: 22px;
      color: #8e9eae;
      margin-left: 8px;
      cursor: pointer;
    }
    .voice-btn.send-btn {
      color: #2ea6ff;
    }

    /* –°–∫—Ä—ã—Ç—ã–π input –¥–ª—è —Ñ–∞–π–ª–æ–≤ */
    #file-input {
      display: none;
    }

    /* –≠–∫—Ä–∞–Ω –Ω–∞—Å—Ç—Ä–æ–µ–∫ */
    .settings-list {
      flex: 1;
      overflow-y: auto;
      padding: 16px;
    }
    .settings-item {
      display: flex;
      align-items: center;
      padding: 16px;
      background: #17212b;
      border-radius: 12px;
      margin-bottom: 8px;
      cursor: pointer;
    }
    .settings-icon {
      font-size: 24px;
      margin-right: 16px;
    }
    .settings-content {
      flex: 1;
    }
    .settings-title {
      font-weight: 600;
    }
    .settings-subtitle {
      font-size: 12px;
      color: #8e9eae;
    }
    .settings-value {
      color: #2ea6ff;
    }

    /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã */
    .theme-switch {
      display: flex;
      gap: 12px;
      margin-top: 8px;
    }
    .theme-option {
      padding: 8px 16px;
      background: #242f3d;
      border-radius: 20px;
      cursor: pointer;
    }
    .theme-option.active {
      background: #2ea6ff;
    }

    /* –≠–º–æ–¥–∑–∏-–ø–∏–∫–µ—Ä (—É–ø—Ä–æ—â—ë–Ω–Ω—ã–π) */
    .emoji-picker {
      position: absolute;
      bottom: 80px;
      right: 16px;
      background: #17212b;
      border-radius: 24px;
      padding: 12px;
      display: grid;
      grid-template-columns: repeat(6, 1fr);
      gap: 8px;
      z-index: 1000;
      box-shadow: 0 4px 20px rgba(0,0,0,0.5);
    }
    .emoji-item {
      font-size: 24px;
      cursor: pointer;
      text-align: center;
    }
  </style>
</head>
<body class="dark-theme">
  <!-- –û–°–ù–û–í–ù–û–ô –≠–ö–†–ê–ù (–≤—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–µ–Ω) -->
  <div id="main-screen" class="screen active">
    <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å (–º–µ–Ω—è–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–¥–µ–ª–∞) -->
    <div class="top-bar" id="top-bar">
      <h1 id="screen-title">–ß–∞—Ç—ã</h1>
      <button class="edit-btn" id="edit-btn" style="display: none;">–ò–∑–º.</button>
      <button class="create-btn" id="create-btn" style="display: none;">üìù</button>
    </div>

    <!-- –ü–æ–∏—Å–∫ (—Ç–æ–ª—å–∫–æ –¥–ª—è —á–∞—Ç–æ–≤) -->
    <div class="search-box" id="search-box">
      <input type="text" id="search-input" placeholder="–ü–æ–∏—Å–∫...">
    </div>

    <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—á–∞—Ç—ã / –Ω–∞—Å—Ç—Ä–æ–π–∫–∏) -->
    <div id="content-area" style="flex: 1; overflow-y: auto;">
      <!-- –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ -->
      <div id="chats-view" class="view active">
        <div class="chats-list" id="chats-list">
          <!-- –û–¥–∏–Ω —á–∞—Ç —Å –±–æ—Ç–æ–º -->
          <div class="chat-item" data-chat-id="bot" onclick="openChat('bot')">
            <div class="chat-avatar">ü§ñ</div>
            <div class="chat-info">
              <div class="chat-name">Zhuravlev Bot</div>
              <div class="chat-last-msg" id="bot-last-msg">–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç-–ø–æ–º–æ—â–Ω–∏–∫</div>
            </div>
            <div class="chat-meta">
              <div class="chat-time" id="bot-time">12:34</div>
              <div class="chat-status"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
      <div id="settings-view" class="view" style="display: none;">
        <div class="settings-list">
          <div class="settings-item" onclick="toggleNotifications()">
            <div class="settings-icon">üîî</div>
            <div class="settings-content">
              <div class="settings-title">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
              <div class="settings-subtitle">–í–∫–ª/–í—ã–∫–ª</div>
            </div>
            <div class="settings-value" id="notif-status">–í–∫–ª</div>
          </div>
          <div class="settings-item" onclick="togglePrivacy()">
            <div class="settings-icon">üîí</div>
            <div class="settings-content">
              <div class="settings-title">–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å</div>
              <div class="settings-subtitle">–ö—Ç–æ –≤–∏–¥–∏—Ç –Ω–æ–º–µ—Ä</div>
            </div>
            <div class="settings-value" id="privacy-status">–ù–∏–∫—Ç–æ</div>
          </div>
          <div class="settings-item">
            <div class="settings-icon">üé®</div>
            <div class="settings-content">
              <div class="settings-title">–¢–µ–º–∞</div>
              <div class="settings-subtitle">–°–≤–µ—Ç–ª–∞—è / –¢—ë–º–Ω–∞—è</div>
            </div>
            <div class="theme-switch">
              <div class="theme-option" onclick="setTheme('light')">‚òÄÔ∏è</div>
              <div class="theme-option active" onclick="setTheme('dark')">üåô</div>
            </div>
          </div>
          <div class="settings-item" onclick="setLanguage()">
            <div class="settings-icon">üåê</div>
            <div class="settings-content">
              <div class="settings-title">–Ø–∑—ã–∫</div>
              <div class="settings-subtitle">–†—É—Å—Å–∫–∏–π</div>
            </div>
            <div class="settings-value">üá∑üá∫</div>
          </div>
          <div class="settings-item" onclick="showAbout()">
            <div class="settings-icon">‚ÑπÔ∏è</div>
            <div class="settings-content">
              <div class="settings-title">–û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</div>
              <div class="settings-subtitle">–í–µ—Ä—Å–∏—è 1.0</div>
            </div>
          </div>
        </div>
      </div>

      <!-- –û–∫–Ω–æ —á–∞—Ç–∞ (—Å–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
      <div id="chat-window" class="chat-window" style="display: none;">
        <div class="chat-header">
          <button class="back-btn" onclick="closeChat()">‚Üê</button>
          <div class="chat-header-info">
            <div class="chat-header-name" id="chat-header-name">Zhuravlev Bot</div>
            <div class="chat-header-status" id="chat-header-status">–æ–Ω–ª–∞–π–Ω</div>
          </div>
          <button class="edit-btn" style="margin-right: 0;" onclick="showBotMenu()">‚ãÆ</button>
        </div>
        <div class="messages-area" id="messages-area">
          <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
        </div>
        <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ -->
        <div class="input-area">
          <button class="attach-btn" onclick="document.getElementById('file-input').click()">üìé</button>
          <div class="input-wrapper">
            <input type="text" id="message-input" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ" oninput="handleTyping()">
            <button class="emoji-btn" onclick="toggleEmojiPicker()">üòÄ</button>
            <button class="voice-btn" id="send-btn" onclick="sendMessage()">‚û§</button>
          </div>
        </div>
        <!-- –°–∫—Ä—ã—Ç—ã–π input –¥–ª—è —Ñ–∞–π–ª–æ–≤ -->
        <input type="file" id="file-input" onchange="uploadFile()" style="display: none;">
        <!-- –≠–º–æ–¥–∑–∏-–ø–∏–∫–µ—Ä (—Å–∫—Ä—ã—Ç) -->
        <div id="emoji-picker" class="emoji-picker" style="display: none;">
          <span class="emoji-item" onclick="addEmoji('üòä')">üòä</span>
          <span class="emoji-item" onclick="addEmoji('üòÇ')">üòÇ</span>
          <span class="emoji-item" onclick="addEmoji('‚ù§Ô∏è')">‚ù§Ô∏è</span>
          <span class="emoji-item" onclick="addEmoji('üëç')">üëç</span>
          <span class="emoji-item" onclick="addEmoji('üî•')">üî•</span>
          <span class="emoji-item" onclick="addEmoji('üéâ')">üéâ</span>
          <span class="emoji-item" onclick="addEmoji('ü§î')">ü§î</span>
          <span class="emoji-item" onclick="addEmoji('üëè')">üëè</span>
          <span class="emoji-item" onclick="addEmoji('üôè')">üôè</span>
          <span class="emoji-item" onclick="addEmoji('üíØ')">üíØ</span>
        </div>
      </div>
    </div>

    <!-- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
    <div class="bottom-nav">
      <div class="nav-item active" data-view="chats" onclick="switchView('chats')">
        <i>üí¨</i><span>–ß–∞—Ç—ã</span>
      </div>
      <div class="nav-item" data-view="settings" onclick="switchView('settings')">
        <i>‚öôÔ∏è</i><span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
      </div>
    </div>
  </div>

  <script>
    // ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
    let currentView = 'chats';
    let currentChat = null; // 'bot' –∏–ª–∏ null
    let messages = [];
    let botMessages = [
      { id: '1', sender: 'bot', content: '–ü—Ä–∏–≤–µ—Ç! –Ø Zhuravlev Bot ü§ñ', time: new Date() },
      { id: '2', sender: 'bot', content: '–Ø –º–æ–≥—É –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è, –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —ç–º–æ–¥–∑–∏ –∏ —Ñ–∞–π–ª—ã!', time: new Date() },
      { id: '3', sender: 'bot', content: '–ü–æ–ø—Ä–æ–±—É–π –Ω–∞–ø–∏—Å–∞—Ç—å –º–Ω–µ —á—Ç–æ-–Ω–∏–±—É–¥—å –∏–ª–∏ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª.', time: new Date() }
    ];
    let notifications = true;
    let privacy = '–ù–∏–∫—Ç–æ';
    let theme = 'dark';

    // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ====================
    document.addEventListener('DOMContentLoaded', () => {
      // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—É—é —Ç–µ–º—É
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme) setTheme(savedTheme, false);

      // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è (–¥–ª—è –¥–µ–º–æ)
      messages = [...botMessages];
      renderMessages();

      // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Å–ø–∏—Å–∫–µ —á–∞—Ç–æ–≤
      updateLastMessage();
    });

    // ==================== –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –†–ê–ó–î–ï–õ–û–í ====================
    function switchView(view) {
      currentView = view;
      document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
      document.querySelector(`[data-view="${view}"]`).classList.add('active');

      document.getElementById('chats-view').style.display = view === 'chats' ? 'block' : 'none';
      document.getElementById('settings-view').style.display = view === 'settings' ? 'block' : 'none';

      const title = document.getElementById('screen-title');
      const editBtn = document.getElementById('edit-btn');
      const createBtn = document.getElementById('create-btn');
      const searchBox = document.getElementById('search-box');

      if (view === 'chats') {
        title.textContent = '–ß–∞—Ç—ã';
        editBtn.style.display = 'inline-block';
        createBtn.style.display = 'inline-block';
        searchBox.style.display = 'block';
      } else if (view === 'settings') {
        title.textContent = '–ù–∞—Å—Ç—Ä–æ–π–∫–∏';
        editBtn.style.display = 'none';
        createBtn.style.display = 'none';
        searchBox.style.display = 'none';
      }
    }

    // ==================== –ß–ê–¢ –° –ë–û–¢–û–ú ====================
    function openChat(chatId) {
      currentChat = chatId;
      document.getElementById('chats-view').style.display = 'none';
      document.getElementById('settings-view').style.display = 'none';
      document.getElementById('chat-window').style.display = 'flex';
      document.getElementById('top-bar').style.display = 'none';
      document.getElementById('search-box').style.display = 'none';

      // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è (—É–∂–µ –µ—Å—Ç—å)
      renderMessages();
      scrollToBottom();
    }

    function closeChat() {
      currentChat = null;
      document.getElementById('chat-window').style.display = 'none';
      document.getElementById('chats-view').style.display = 'block';
      document.getElementById('top-bar').style.display = 'flex';
      document.getElementById('search-box').style.display = 'block';
    }

    function renderMessages() {
      const area = document.getElementById('messages-area');
      area.innerHTML = '';
      messages.forEach(msg => {
        const isOwn = msg.sender === 'me';
        const msgDiv = document.createElement('div');
        msgDiv.className = `message ${isOwn ? 'own' : 'other'}`;
        msgDiv.dataset.id = msg.id;

        let contentHtml = '';
        if (msg.type === 'file') {
          contentHtml = `
            <div class="file-message">
              <span class="file-icon">üìé</span>
              <span class="file-name">${msg.fileName || '–§–∞–π–ª'}</span>
            </div>
          `;
        } else {
          contentHtml = `<div class="message-content">${escapeHtml(msg.content)}</div>`;
        }

        const time = new Date(msg.time).toLocaleTimeString('ru', { hour: '2-digit', minute: '2-digit' });

        msgDiv.innerHTML = `
          <div class="message-bubble ${isOwn ? 'own-bubble' : 'other-bubble'}">
            ${contentHtml}
            <div class="message-time">${time}</div>
          </div>
        `;
        area.appendChild(msgDiv);
      });
    }

    function sendMessage() {
      const input = document.getElementById('message-input');
      const content = input.value.trim();
      if (!content) return;

      // –î–æ–±–∞–≤–ª—è–µ–º —Å–≤–æ—ë —Å–æ–æ–±—â–µ–Ω–∏–µ
      const newMsg = {
        id: Date.now().toString(),
        sender: 'me',
        content: content,
        time: new Date(),
        type: 'text'
      };
      messages.push(newMsg);
      renderMessages();
      input.value = '';
      document.getElementById('send-btn').className = 'voice-btn';
      document.getElementById('send-btn').textContent = 'üé§';

      // –û—Ç–≤–µ—Ç –±–æ—Ç–∞ (–∏–º–∏—Ç–∞—Ü–∏—è)
      setTimeout(() => {
        const botReply = {
          id: (Date.now() + 1).toString(),
          sender: 'bot',
          content: generateBotReply(content),
          time: new Date(),
          type: 'text'
        };
        messages.push(botReply);
        renderMessages();
        scrollToBottom();
        updateLastMessage(botReply.content);
      }, 1000);

      scrollToBottom();
      updateLastMessage(content);
    }

    function generateBotReply(userMsg) {
      const lower = userMsg.toLowerCase();
      if (lower.includes('–ø—Ä–∏–≤–µ—Ç')) return '–ò —Ç–µ–±–µ –ø—Ä–∏–≤–µ—Ç! üëã';
      if (lower.includes('–∫–∞–∫ –¥–µ–ª–∞')) return '–£ –º–µ–Ω—è –≤—Å—ë –æ—Ç–ª–∏—á–Ω–æ, —Å–ø–∞—Å–∏–±–æ! –ê —É —Ç–µ–±—è?';
      if (lower.includes('–±–æ—Ç')) return '–î–∞, —è –±–æ—Ç ü§ñ';
      if (lower.includes('–∫—Ä—É—Ç–æ')) return '–°–ø–∞—Å–∏–±–æ! üòä';
      if (lower.includes('–ø–æ–∫–∞')) return '–î–æ –≤—Å—Ç—Ä–µ—á–∏! üëã';
      return '–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ... –†–∞—Å—Å–∫–∞–∂–∏ –ø–æ–¥—Ä–æ–±–Ω–µ–µ!';
    }

    function uploadFile() {
      const fileInput = document.getElementById('file-input');
      const file = fileInput.files[0];
      if (!file) return;

      const newMsg = {
        id: Date.now().toString(),
        sender: 'me',
        content: `üìé ${file.name}`,
        fileName: file.name,
        time: new Date(),
        type: 'file'
      };
      messages.push(newMsg);
      renderMessages();
      scrollToBottom();

      // –û—Ç–≤–µ—Ç –±–æ—Ç–∞ –Ω–∞ —Ñ–∞–π–ª
      setTimeout(() => {
        const botReply = {
          id: (Date.now() + 1).toString(),
          sender: 'bot',
          content: `–ü–æ–ª—É—á–∏–ª —Ñ–∞–π–ª: ${file.name} üìÇ`,
          time: new Date(),
          type: 'text'
        };
        messages.push(botReply);
        renderMessages();
        scrollToBottom();
      }, 1000);

      fileInput.value = ''; // —Å–±—Ä–æ—Å
    }

    function handleTyping() {
      const input = document.getElementById('message-input');
      const sendBtn = document.getElementById('send-btn');
      if (input.value.trim().length > 0) {
        sendBtn.className = 'voice-btn send-btn';
        sendBtn.textContent = '‚û§';
      } else {
        sendBtn.className = 'voice-btn';
        sendBtn.textContent = 'üé§';
      }
    }

    function toggleEmojiPicker() {
      const picker = document.getElementById('emoji-picker');
      picker.style.display = picker.style.display === 'none' ? 'grid' : 'none';
    }

    function addEmoji(emoji) {
      const input = document.getElementById('message-input');
      input.value += emoji;
      input.focus();
      toggleEmojiPicker();
      handleTyping();
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function scrollToBottom() {
      const area = document.getElementById('messages-area');
      area.scrollTop = area.scrollHeight;
    }

    function updateLastMessage(text) {
      const lastMsgEl = document.getElementById('bot-last-msg');
      const timeEl = document.getElementById('bot-time');
      if (text) {
        lastMsgEl.textContent = text.length > 30 ? text.slice(0, 30) + '‚Ä¶' : text;
        const now = new Date();
        timeEl.textContent = now.toLocaleTimeString('ru', { hour: '2-digit', minute: '2-digit' });
      }
    }

    // ==================== –ù–ê–°–¢–†–û–ô–ö–ò ====================
    function toggleNotifications() {
      notifications = !notifications;
      document.getElementById('notif-status').textContent = notifications ? '–í–∫–ª' : '–í—ã–∫–ª';
    }

    function togglePrivacy() {
      const options = ['–ù–∏–∫—Ç–æ', '–ú–æ–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã', '–í—Å–µ'];
      let idx = options.indexOf(privacy);
      idx = (idx + 1) % options.length;
      privacy = options[idx];
      document.getElementById('privacy-status').textContent = privacy;
    }

    function setTheme(newTheme, save = true) {
      theme = newTheme;
      document.body.classList.toggle('light-theme', newTheme === 'light');
      document.querySelectorAll('.theme-option').forEach(opt => opt.classList.remove('active'));
      if (newTheme === 'light') {
        document.querySelector('.theme-option[onclick="setTheme(\'light\')"]').classList.add('active');
      } else {
        document.querySelector('.theme-option[onclick="setTheme(\'dark\')"]').classList.add('active');
      }
      if (save) localStorage.setItem('theme', newTheme);
    }

    function setLanguage() {
      alert('–°–º–µ–Ω–∞ —è–∑—ã–∫–∞ (–∑–∞–≥–ª—É—à–∫–∞)');
    }

    function showAbout() {
      alert('Zhuravlev Telegram Clone v1.0\n–°–¥–µ–ª–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è —Ç–µ—Å—Ç–∞');
    }

    function showBotMenu() {
      alert('–ú–µ–Ω—é –±–æ—Ç–∞ (–∑–∞–≥–ª—É—à–∫–∞)');
    }

    // –î–ª—è –ø–æ–∏—Å–∫–∞ (–∑–∞–≥–ª—É—à–∫–∞)
    function filterChats() {}
  </script>
</body>
</html>
